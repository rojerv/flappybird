import{P as h}from"./vendor.c2cc9365.js";const b=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const y of n.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&o(y)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}};b();var r;(function(t){t.bg="bg",t.bird="bird",t.ground="ground",t.pipeBottom="pipeBottom",t.pipeTop="pipeTop",t.gameOver="gameOver",t.intro="intro"})(r||(r={}));const P={[r.bg]:"background-day.png",[r.bird]:"bird-yellow-sprite.png",[r.ground]:"ground-sprite.png",[r.pipeTop]:"pipe-green-top.png",[r.pipeBottom]:"pipe-green-bottom.png",[r.gameOver]:"gameover.png",[r.intro]:"message-initial.png"};class G extends h.Scene{constructor(){super({key:c.BOOT})}preload(){this.load.setBaseURL(F.assets.graphics);for(const e of Object.keys(r)){const s=e;if(s===r.bird){this.load.spritesheet(s,P[s],{frameWidth:34,frameHeight:24});continue}if(s===r.ground){this.load.spritesheet(s,P[s],{frameWidth:336,frameHeight:112});continue}this.load.image(s,P[s])}}create(){this.scene.start(c.LOBBY)}}const a={WIDTH:288,HEIGHT:512,GRAVITY:300,PIPES:{MARGIN:100,PIPE_HEIGHT:320,PIPE_WIDTH:52,STEP:200,SPEED:100,BETWEEN:[-60,130]},PLAYER:{MOVE_FRAMES:12,SPEED:150}};var d;(function(t){t.move="move"})(d||(d={}));class f extends h.Physics.Arcade.Sprite{constructor(e){super(e,a.WIDTH/2,a.HEIGHT,r.ground);this._scene=e,e.add.existing(this),e.physics.add.existing(this),this.setDepth(p.GROUND),this.setCollideWorldBounds(!0)}createAnims(){return this._scene.anims.create({key:d.move,frames:this._scene.anims.generateFrameNumbers(r.ground,{start:0,end:2}),frameRate:15,repeat:-1}),this}animate(){return this.anims.play(d.move),this}static init(e){return new this(e)}}const v=new h.Events.EventEmitter;var l;(function(t){t.UPDATE="update"})(l||(l={}));var u;(function(t){t.ADD_PIPES="ADD_PIPES"})(u||(u={}));var E;(function(t){t.CLICK_CITY="pointerdown"})(E||(E={}));class T extends h.GameObjects.Image{constructor(e){super(e,a.WIDTH/2,a.HEIGHT/2,r.bg);this._scene=e,e.add.existing(this),this.setDepth(p.CITY),this.setInteractive()}subscribe(e){this.on(E.CLICK_CITY,e,this._scene)}static init(e){return new this(e)}}const{WIDTH:O}=a;class A extends h.Scene{constructor(){super({key:c.LOBBY})}create(){T.init(this).subscribe(this.startGame),f.init(this),this.add.image(O/2,160,r.intro)}startGame(){this.scene.start(c.GAME)}}const{MOVE_FRAMES:D,SPEED:H}=a.PLAYER,S=50;var m;(function(t){t.fly="fly"})(m||(m={}));class _ extends h.Physics.Arcade.Sprite{constructor(e){super(e,0,0,r.bird);this.moveFrames=0,this._scene=e,this.setX(S),this.setY(this._scene.game.canvas.height/2),this.setAngle(0),e.add.existing(this),e.physics.add.existing(this),this.setCollideWorldBounds(!0),this.setGravityY(a.GRAVITY),e.events.on(l.UPDATE,this.update,this)}stopPlayer(){this.setGravityY(0)}fly(){this.moveFrames>0||(this.setVelocityY(-H),this.setAngle(-50),this.moveFrames=D)}update(){var s,o;if(!((o=(s=this.body)==null?void 0:s.gravity)==null?void 0:o.y))return;this.moveFrames>0&&this.moveFrames--;const e=this.angle;e<90&&this.setAngle(e+1)}createAnims(){return this._scene.anims.create({key:m.fly,frames:this._scene.anims.generateFrameNumbers(r.bird,{start:0,end:2}),frameRate:10,repeat:-1}),this}animate(){return this.anims.play(m.fly),this}static init(e){return new this(e)}}const{MARGIN:B,PIPE_HEIGHT:x,SPEED:R,STEP:I,BETWEEN:g}=a.PIPES,Y=3;class C extends h.Physics.Arcade.Group{constructor(e){super(e.physics.world,e);this._scene=e,e.events.on(l.UPDATE,this.update,this)}stopPipes(){this.setVelocityX(0)}generatePipes(){let e=0;const s=a.WIDTH;for(;e<Y;){const o=s+ ++e*I,i=h.Math.Between(g[0],g[1]);this.addPipes(o,i)}return this}addPipes(e,s){const o=this.addPipe(e,s,"top"),i=this.addPipe(e,s+B+x,"bottom");return this.setVelocityX(-R),v.emit(u.ADD_PIPES,e,s),[o,i]}addPipe(e,s,o){const i=o==="top"?r.pipeTop:r.pipeBottom,n=this.create(e,s,i);return n.setPushable(!1),n}update(){const e=this.getChildren()[0],s=this.getChildren()[1];if(!e||e.x>-100)return;e.destroy(),s.destroy();const i=this.getLast(!0).x+I,n=h.Math.Between(g[0],g[1]);this.addPipes(i,n)}}const{PIPE_WIDTH:L,SPEED:w}=a.PIPES;class W extends h.Physics.Arcade.Group{constructor(e){super(e.physics.world,e);this._scene=e,this.subscribe()}subscribe(){v.on(u.ADD_PIPES,this.addGap.bind(this))}addGap(e){const s=e+L/2,o=a.HEIGHT/2,i=this._scene.add.line(s,o,0,0,0,a.HEIGHT);return this.add(i),this.setVelocityX(-w),i}}const{HEIGHT:N,WIDTH:M}=a;class V extends h.Scene{constructor(){super({key:c.GAME});this.points=0}create(){this.player=_.init(this).createAnims().animate(),this.ground=f.init(this).createAnims().animate(),this.pipes=new C(this),this.gaps=new W(this),this.pointsText=this.add.text(16,16,"0",{fontSize:"32px"}),this.pointsText.setDepth(p.POINTS),this.gameOver=this.add.image(M/2,N/2,r.gameOver),this.gameOver.setVisible(!1),this.gameOver.setDepth(p.GAME_OVER),T.init(this).subscribe(this.clickOnGame),this.physics.add.collider(this.player,this.ground,this.hit,void 0,this),this.physics.add.collider(this.player,this.pipes,this.hit,void 0,this),this.physics.add.overlap(this.player,this.gaps,this.getPoint,void 0,this),this.pipes.generatePipes()}clickOnGame(){this.gameOver.visible?this.scene.start(c.LOBBY):this.player.fly()}getPoint(e,s){s.destroy(),this.points++,this.pointsText.setText(`${this.points}`)}hit(){this.physics.pause(),this.gameOver.setVisible(!0),this.pipes.stopPipes(),this.player.stopPlayer()}}var c;(function(t){t.BOOT="boot",t.LOBBY="lobby",t.GAME="game"})(c||(c={}));const F={assets:{graphics:"/flappybird/img"}};var p;(function(t){t[t.CITY=-10]="CITY",t[t.GROUND=1]="GROUND",t[t.POINTS=10]="POINTS",t[t.GAME_OVER=11]="GAME_OVER"})(p||(p={}));const k={width:a.WIDTH,height:a.HEIGHT,type:h.AUTO,parent:"game",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[G,A,V],title:"Flappy Bird",version:"1.0.0"};class U{start(e){const s=k;s.parent=e,this.game=new Phaser.Game(s)}}new U().start("game");
